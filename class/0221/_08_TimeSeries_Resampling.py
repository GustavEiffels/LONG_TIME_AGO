import numpy as np
import pandas as pd

import _00_Common

# 2분 단위로 생성
print("2분 단위로 생성")
time_index = pd.date_range('2022-02-01', '2022-02-21', freq='2min')
df = pd.DataFrame(index=time_index)[:100]
df['price'] = np.random.randint(low=10, high=100, size=100)
print(df.head())
print()
'''
2분 단위로 생성
                     price
2022-02-01 00:00:00     66
2022-02-01 00:02:00     17
2022-02-01 00:04:00     26
2022-02-01 00:06:00     84
2022-02-01 00:08:00     66

'''
print('''
----> 지금 같은 경우 데이터를 너무 자주 수집했다 . 
데이터를 줄여나갈 필요성을 느낌 
: resample 을 시도 
''')
# 데이터를 10분 단위로 변경
print(df['price'].resample('10T').first())
print()
'''
result 
2022-02-01 00:00:00    54
2022-02-01 00:10:00    45
2022-02-01 00:20:00    63
2022-02-01 00:30:00    85
2022-02-01 00:40:00    35
2022-02-01 00:50:00    33
2022-02-01 01:00:00    61
2022-02-01 01:10:00    41
2022-02-01 01:20:00    25
2022-02-01 01:30:00    98
2022-02-01 01:40:00    18
2022-02-01 01:50:00    53
2022-02-01 02:00:00    86
2022-02-01 02:10:00    87
2022-02-01 02:20:00    33
2022-02-01 02:30:00    47
2022-02-01 02:40:00    94
2022-02-01 02:50:00    62
2022-02-01 03:00:00    69
2022-02-01 03:10:00    99
Freq: 10T, Name: price, dtype: int64
'''

# 10분 단위 합계
print("10분 단위 합계")
print(df['price'].resample('10T').sum())
print()
'''
result 
10분 단위 합계
2022-02-01 00:00:00    251
2022-02-01 00:10:00    287
2022-02-01 00:20:00    375
2022-02-01 00:30:00    283
2022-02-01 00:40:00    278
2022-02-01 00:50:00    245
2022-02-01 01:00:00    152
2022-02-01 01:10:00    432
2022-02-01 01:20:00    288
2022-02-01 01:30:00    306
2022-02-01 01:40:00    379
2022-02-01 01:50:00    238
2022-02-01 02:00:00    221
2022-02-01 02:10:00    362
2022-02-01 02:20:00    242
2022-02-01 02:30:00    292
2022-02-01 02:40:00    135
2022-02-01 02:50:00    265
2022-02-01 03:00:00    203
2022-02-01 03:10:00    321
Freq: 10T, Name: price, dtype: int64
'''

''' UpSampling ------------------------------------'''
print(" 데이터를 2개만 생성 -----------")
time_index = pd.date_range('1/1/2022', periods=2, freq="M")
ts = pd.Series(np.arange(2), index=time_index)
print(ts)
print()
'''
데이터를 2개만 생성 -----------
2022-01-31    0
2022-02-28    1
Freq: M, dtype: int64
'''

print(" UpSample ")
print(ts.resample('W').bfill())
print()
'''
UpSample 
2022-02-06    1.0
2022-02-13    1.0
2022-02-20    1.0
2022-02-27    1.0
2022-03-06    NaN
Freq: W-SUN, dtype: float64
'''
